# 작업 로그 - 2026-02-05

## 요약

| 항목 | 수치 |
|------|------|
| 총 커밋 | 17개 |
| 테스트 | 189개 통과 |
| 커버리지 | 88.99% |
| 신규 파일 | 25개 |
| 수정 파일 | 15개+ |

### 주요 성과
- **Phase 1 완료**: 서비스 레이어 (TDD, 100% 커버리지)
- **Phase 1.5 진행**: 캘린더 뷰 구현 완료
- **아키텍처 결정**: Offline-First (AsyncStorage + Google Sheets 백업)

---

## 1. 서비스 레이어 개발 (TDD)

### 1.1 Category 도메인
- 타입: `Category`, `CreateCategoryInput`, `UpdateCategoryInput`
- 인터페이스: `ICategoryService`
- 메서드: create, getById, getAll, getByType, update, delete, clear
- 테스트: 19개 (100% 커버리지)

### 1.2 PaymentMethod 도메인
- 타입: `PaymentMethod`, `CreatePaymentMethodInput`, `UpdatePaymentMethodInput`
- 인터페이스: `IPaymentMethodService`
- 메서드: create, getById, getAll, update, delete, clear
- 테스트: 16개 (100% 커버리지)

### 1.3 Transaction 도메인
- 타입: `Transaction`, `CreateTransactionInput`, `UpdateTransactionInput`, `DailySummary`
- 인터페이스: `ITransactionService`
- CRUD: create, getById, getAll, update, delete, clear
- 조회: getByType, getByDateRange, getByCategoryId, getByPaymentMethodId, getByDate
- 집계: getTotalIncome, getTotalExpense, getBalance, getDailySummaries
- 테스트: 45개 (100% 커버리지)

---

## 2. UI 개발

### 2.1 네비게이션
- `@react-navigation/native`, `@react-navigation/bottom-tabs` 설치
- 하단 탭: 홈 | 추가 | 설정 (3탭)

### 2.2 화면 (Screens)
| 화면 | 기능 | 테스트 |
|------|------|--------|
| HomeScreen | 거래 목록, 요약 카드, 필터, 캘린더 뷰 | 13개 |
| AddTransactionScreen | 거래 추가 폼 | 17개 |
| SettingsScreen | 카테고리/결제수단 관리 (탭 전환) | 18개 |

### 2.3 공통 컴포넌트
| 컴포넌트 | 기능 | 테스트 |
|----------|------|--------|
| SummaryCard | 잔액/수입/지출 요약 | 9개 |
| TransactionItem | 거래 항목 표시 | 11개 |
| ViewToggle | 리스트/캘린더 전환 | 4개 |
| CalendarHeader | 월 네비게이션 | 4개 |
| CalendarGrid | 달력 그리드 | 5개 |
| DayCell | 날짜 셀 (일별 잔액) | 10개 |
| DayDetailModal | 날짜별 거래 상세 | 15개 |

---

## 3. UX 개선

### 3.1 화면 통합
- CategoriesScreen + PaymentMethodsScreen → SettingsScreen
- 탭 네비게이션으로 카테고리/결제수단 전환
- 카테고리 내 지출/수입 서브탭

### 3.2 알림 피드백
- 카테고리/결제수단 생성: `"[이름]" 카테고리가 생성되었습니다`
- 삭제: 확인 다이얼로그
- 거래 등록: `[확인]` / `[계속 등록하기]` 선택

### 3.3 데이터 즉시 반영
- 문제: CRUD 후 화면에 즉시 반영 안됨
- 해결: Alert.alert() 전에 loadData() 호출
- useFocusEffect로 화면 포커스 시 새로고침

---

## 4. 캘린더 뷰

### 4.1 기능
- 리스트/캘린더 뷰 토글
- 월별 네비게이션 (이전/다음)
- 일별 잔액 표시 (수입: 초록, 지출: 빨강)
- 월별 요약 (수입/지출/잔액)
- 날짜 클릭 시 모달로 상세 거래 표시

### 4.2 컴포넌트 구조
```
HomeScreen
├── ViewToggle (리스트/캘린더 전환)
├── [리스트 뷰]
│   ├── SummaryCard
│   ├── FilterButtons
│   └── TransactionList
└── [캘린더 뷰]
    ├── CalendarHeader
    ├── MonthlySummary
    ├── CalendarGrid
    │   └── DayCell
    └── DayDetailModal
```

---

## 5. 아키텍처 결정

### Offline-First 채택
```
┌─────────────────────────────────────┐
│       AsyncStorage (주 저장소)       │
│  - 모든 CRUD 작업                   │
│  - 오프라인 완전 지원                │
└─────────────────┬───────────────────┘
                  │ 수동 백업/복원
┌─────────────────▼───────────────────┐
│      Google Sheets (백업용)          │
│  - 내보내기/가져오기                 │
│  - 기기 변경 시 데이터 이전          │
└─────────────────────────────────────┘
```

### 이유
- Google Sheets API 제한: 60회/분/사용자
- 오프라인 사용 필수 (지하철 등)
- 단일 기기 사용 전제 → 동기화 단순화

---

## 6. 문서화

### 신규 문서
- `docs/design/data-architecture.md`: 데이터 아키텍처 설계
- `docs/design/calendar-view.md`: 캘린더 뷰 설계
- `docs/api/README.md`: API 개요
- `docs/api/categories.md`: CategoryService API
- `docs/api/payment-methods.md`: PaymentMethodService API
- `docs/api/transactions.md`: TransactionService API

### 업데이트
- `README.md`: 로드맵, 프로젝트 구조
- `docs/design/2026-02-04-initial.md`: Phase 재정의

---

## 7. 커밋 이력

| # | 커밋 메시지 |
|---|-------------|
| 1 | Chore: 테스트 커버리지 목표 100%로 상향 |
| 2 | Feat: Category 도메인 모델 및 서비스 구현 |
| 3 | Feat: PaymentMethod 도메인 모델 및 서비스 구현 |
| 4 | Feat: Transaction 도메인 모델 및 서비스 구현 |
| 5 | Docs: API 문서 작성 |
| 6 | Feat: 거래 관리 UI 전체 화면 구현 |
| 7 | Docs: 2026-02-05 작업 로그 업데이트 |
| 8 | UX: 카테고리/결제수단 생성, 삭제 알림 피드백 추가 |
| 9 | Refactor: 카테고리/결제수단 화면 → 설정 화면으로 통합 |
| 10 | UX: 거래 등록 후 [확인]/[계속 등록하기] 선택 기능 |
| 11 | Fix: 데이터 생성/삭제 후 즉시 반영되도록 수정 |
| 12 | Test: UI 컴포넌트 테스트 코드 추가 |
| 13 | Feat: TransactionService에 캘린더 뷰 지원 메서드 추가 |
| 14 | Feat: 캘린더 뷰 UI 컴포넌트 구현 |
| 15 | Feat: HomeScreen에 캘린더 뷰 통합 |
| 16 | Test: 캘린더 뷰 관련 테스트 추가 |
| 17 | Docs: 캘린더 뷰 및 데이터 아키텍처 문서 추가 |

---

## 8. 최종 테스트 결과

```
Test Suites: 14 passed, 14 total
Tests:       189 passed, 189 total

Coverage Summary:
├── Statements: 88.99% (380/427)
├── Branches:   90.24% (185/205)
├── Functions:  84.61% (132/156)
└── Lines:      88.88% (368/414)
```

### 커버리지 기준
| 영역 | 목표 | 달성 |
|------|------|------|
| 서비스 레이어 | 100% | 100% |
| UI 공통 컴포넌트 | 100% | 100% |
| 화면 컴포넌트 | 75% | 75%+ |
| 전체 | 80% | 88.99% |

---

## 9. 다음 작업 (2월 6일 예정)

### 우선순위 1: 날짜 선택 기능
- 거래 등록 시 날짜 선택
- 빠른 선택 (오늘/어제) + 달력 픽커

### 우선순위 2: AsyncStorage 연동
- 데이터 영속성 구현
- 앱 종료 후에도 데이터 유지

### 우선순위 3: 테마 시스템
- Light/Dark 모드 지원
