# CloudPocket 설계 문서

## 1. 프로젝트 개요

개인 재정 관리 모바일 애플리케이션. 초기에는 로컬 데이터로 동작하며, 이후 Google Sheets 연동을 통해 실시간 동기화 지원 예정.

### 비전
- **Phase 1**: 기본 가계부 (지출/수익 기록)
- **Phase 2**: Google Sheets 실시간 연동
- **Phase 3**: 자산 관리 및 재무 분석 고도화

---

## 2. 핵심 기능

### 2.1 거래 관리
| 기능 | 설명 |
|------|------|
| 수입 등록 | 금액, 카테고리, 메모, 날짜 |
| 지출 등록 | 금액, 카테고리, 메모, 날짜 |
| 거래 수정/삭제 | 기존 기록 편집 |

### 2.2 뷰 모드

#### 캘린더 뷰
- 월별 캘린더 형식
- 각 날짜에 일일 합계 표시
  - `+` 잔액: **초록색**
  - `-` 잔액: **빨간색**
- 날짜 선택 시 해당 일의 거래 목록 표시

#### 리스트 뷰 (스택 형식)
- 일자별 그룹핑
- 각 거래의 상세 정보 표시
  - 시간, 카테고리, 금액, 메모
- 무한 스크롤 또는 페이지네이션

### 2.3 테마
- **Light Mode**: 기본 밝은 테마
- **Dark Mode**: 어두운 테마
- 시스템 설정 연동 옵션

---

## 3. 화면 구성

```
┌─────────────────────────────────────┐
│            Tab Navigator            │
├─────────────┬─────────────┬─────────┤
│  Calendar   │    List     │ Settings│
│    Tab      │    Tab      │   Tab   │
└─────────────┴─────────────┴─────────┘
```

### 3.1 화면 목록

| 화면 | 경로 | 설명 |
|------|------|------|
| CalendarScreen | `/calendar` | 캘린더 뷰 메인 |
| ListScreen | `/list` | 리스트 뷰 메인 |
| TransactionDetailScreen | `/transaction/:id` | 거래 상세/수정 |
| AddTransactionScreen | `/transaction/add` | 거래 추가 |
| SettingsScreen | `/settings` | 설정 화면 |

### 3.2 화면 와이어프레임

#### 캘린더 화면
```
┌────────────────────────────┐
│  ◀  2026년 2월  ▶         │
├────────────────────────────┤
│ 일  월  화  수  목  금  토 │
├────────────────────────────┤
│                        1   │
│                     +5000  │
├────────────────────────────┤
│  2    3    4    5    6  ...│
│-2000 +500      -1500       │
├────────────────────────────┤
│         ...                │
└────────────────────────────┘
│  [+] 거래 추가 버튼        │
└────────────────────────────┘
```

#### 리스트 화면
```
┌────────────────────────────┐
│  2026년 2월               │
├────────────────────────────┤
│ ▼ 2월 4일 (화)    +3,000  │
│ ├─ 09:00 월급    +50,000  │
│ ├─ 12:30 점심     -8,000  │
│ └─ 18:00 커피     -5,000  │
├────────────────────────────┤
│ ▼ 2월 3일 (월)   -12,000  │
│ ├─ ...                     │
└────────────────────────────┘
```

---

## 4. 데이터 모델

### 4.1 Transaction (거래)
```typescript
interface Transaction {
  id: string;
  type: 'income' | 'expense';
  amount: number;           // 양수 값
  category: string;
  memo?: string;
  date: string;             // ISO 8601 (YYYY-MM-DD)
  time?: string;            // HH:mm
  createdAt: string;
  updatedAt: string;
}
```

### 4.2 Category (카테고리)
```typescript
interface Category {
  id: string;
  name: string;
  type: 'income' | 'expense';
  icon?: string;
  color?: string;
}
```

### 4.3 DailySummary (일별 요약)
```typescript
interface DailySummary {
  date: string;
  totalIncome: number;
  totalExpense: number;
  balance: number;          // income - expense
  transactions: Transaction[];
}
```

### 4.4 기본 카테고리
```
[수입]
- 월급
- 부수입
- 용돈
- 기타 수입

[지출]
- 식비
- 교통비
- 쇼핑
- 문화/여가
- 공과금
- 의료/건강
- 기타 지출
```

---

## 5. 아키텍처 설계

### 5.1 레이어 구조 (확장성 고려)

```
┌─────────────────────────────────────────┐
│                 Views                    │
│         (React Native Components)        │
└─────────────────┬───────────────────────┘
                  │
┌─────────────────▼───────────────────────┐
│              Controllers                 │
│      (State Management / Hooks)          │
└─────────────────┬───────────────────────┘
                  │
┌─────────────────▼───────────────────────┐
│               Services                   │
│    ┌─────────────────────────────┐      │
│    │    IDataService (Interface) │      │
│    └──────────┬──────────────────┘      │
│               │                          │
│    ┌──────────▼──────────┐              │
│    │  LocalStorageService │ ◀── Phase 1 │
│    └─────────────────────┘              │
│    ┌─────────────────────┐              │
│    │  GoogleSheetsService │ ◀── Phase 2 │
│    └─────────────────────┘              │
└─────────────────────────────────────────┘
                  │
┌─────────────────▼───────────────────────┐
│                Models                    │
│         (Type Definitions)               │
└─────────────────────────────────────────┘
```

### 5.2 서비스 인터페이스 (확장성 핵심)

```typescript
// 데이터 소스 교체가 가능하도록 인터페이스 정의
interface ITransactionService {
  getAll(): Promise<Transaction[]>;
  getByDateRange(start: string, end: string): Promise<Transaction[]>;
  getById(id: string): Promise<Transaction | null>;
  create(data: CreateTransactionDTO): Promise<Transaction>;
  update(id: string, data: UpdateTransactionDTO): Promise<Transaction>;
  delete(id: string): Promise<void>;
  getDailySummary(date: string): Promise<DailySummary>;
  getMonthlySummary(year: number, month: number): Promise<DailySummary[]>;
}
```

Phase 1에서는 `LocalTransactionService`로 구현, Phase 2에서 `GoogleSheetsTransactionService`로 교체/확장.

---

## 6. 테마 시스템

### 6.1 테마 구조
```typescript
interface Theme {
  mode: 'light' | 'dark';
  colors: {
    // 기본
    background: string;
    surface: string;
    text: string;
    textSecondary: string;
    border: string;

    // 시맨틱
    income: string;         // 수입 (초록)
    expense: string;        // 지출 (빨강)
    primary: string;

    // 컴포넌트
    cardBackground: string;
    tabBarBackground: string;
  };
}
```

### 6.2 컬러 팔레트

| 용도 | Light Mode | Dark Mode |
|------|------------|-----------|
| Background | `#FFFFFF` | `#121212` |
| Surface | `#F5F5F5` | `#1E1E1E` |
| Text | `#212121` | `#FFFFFF` |
| Text Secondary | `#757575` | `#B0B0B0` |
| Income (수입) | `#4CAF50` | `#81C784` |
| Expense (지출) | `#F44336` | `#E57373` |
| Primary | `#2196F3` | `#64B5F6` |

---

## 7. 디렉토리 구조 (상세)

```
src/
├── models/
│   └── index.ts                 # Transaction, Category 등 타입
│
├── views/
│   ├── screens/
│   │   ├── CalendarScreen.tsx
│   │   ├── ListScreen.tsx
│   │   ├── TransactionDetailScreen.tsx
│   │   ├── AddTransactionScreen.tsx
│   │   └── SettingsScreen.tsx
│   │
│   └── components/
│       ├── common/
│       │   ├── Button.tsx
│       │   ├── Card.tsx
│       │   └── Input.tsx
│       ├── calendar/
│       │   ├── CalendarHeader.tsx
│       │   ├── CalendarGrid.tsx
│       │   └── DayCell.tsx
│       ├── transaction/
│       │   ├── TransactionItem.tsx
│       │   ├── TransactionList.tsx
│       │   └── TransactionForm.tsx
│       └── layout/
│           └── TabBar.tsx
│
├── controllers/
│   ├── useTransactions.ts       # 거래 관련 상태/로직
│   ├── useCalendar.ts           # 캘린더 네비게이션
│   └── useTheme.ts              # 테마 관리
│
├── services/
│   ├── interfaces/
│   │   └── ITransactionService.ts
│   ├── LocalTransactionService.ts
│   └── index.ts                 # 서비스 팩토리
│
├── utils/
│   ├── date.ts                  # 날짜 유틸
│   ├── format.ts                # 포맷팅 (금액 등)
│   └── storage.ts               # AsyncStorage 래퍼
│
├── constants/
│   ├── categories.ts            # 기본 카테고리
│   └── theme.ts                 # 테마 상수
│
└── types/
    └── index.ts                 # 공통 타입
```

---

## 8. 기술 스택 (추가)

| 항목 | 선택 | 비고 |
|------|------|------|
| Navigation | React Navigation | Tab + Stack |
| State | React Context + useReducer | 경량, 추후 Zustand 고려 |
| Storage | AsyncStorage | 로컬 데이터 저장 |
| Date | date-fns | 경량 날짜 라이브러리 |

---

## 9. 향후 로드맵

### Phase 1: MVP (현재)
- [x] 프로젝트 설정
- [ ] 기본 UI 컴포넌트
- [ ] 캘린더 뷰
- [ ] 리스트 뷰
- [ ] 거래 CRUD
- [ ] 로컬 저장소 연동
- [ ] 테마 (Light/Dark)

### Phase 2: Google Sheets 연동
- [ ] Google OAuth 인증
- [ ] Sheets API 연동
- [ ] 실시간 동기화
- [ ] 오프라인 모드 + 동기화

### Phase 3: 고도화
- [ ] 자산 관리 (계좌, 카드 등록)
- [ ] 예산 설정 및 알림
- [ ] 통계 및 리포트
- [ ] 정기 거래 자동 등록
- [ ] 데이터 내보내기 (CSV, PDF)

---

## 10. 참고사항

- 모든 금액은 정수(원 단위)로 저장
- 날짜는 ISO 8601 형식 사용
- 컴포넌트는 테마 props를 직접 받지 않고 Context 사용
- 서비스 레이어는 항상 인터페이스 기반으로 구현
